#+TITLE: Lab_1
#+STARTUP: latexpreview
#+STARTUP: show2levels
#+INCLUDE: "~/.doom.d/orgReportHeader.org"
* General
** links
- [[https://gla-my.sharepoint.com/:v:/g/personal/jin_yang_glasgow_ac_uk/EXqVvp8iT5NHuPiDp457V_kBwu5OXskIiBeEPEwM_YuBUQ?e=BGTPHO][video recording]]
- [[file:Experiment 1 - Long Transmission Line.pdf][lab1 desc]]
** Terminology
- DVM :: Digital Volt Meter
* Theory
** Surge Impedance
#+NAME: eqSurgeImpedance
\begin{align}
Z_0= \sqrt{\frac{L}{C}}
\end{align}
Where L and C are the line capacitance and reactance. [fn::since this is given as a fraction it doesn't matter weather this is given as a per unit length value or as a total value]
** Electrical Length
This is effectively a measure of the amount of wavelengths of a particular frequency fit into a length of conductor. Electrical length is given by Equation ref:eqElectricalLength.
#+NAME: eqElectricalLength
\begin{align}
\theta=\omega\sqrt{LC}
\end{align}
A value of \(\theta = 2\pi\) would imply a single wavelength, however even for very long lines, typically values are \(\ll 2\pi\).
** Open Circuit Transmission line Voltage distribution
Voltage distribution along the line is given by Equation ref:eqVoltageDist:
#+NAME: eqVoltageDist
\begin{align}
V(x)= V_s \frac{\cos{(\theta(1-x/a))}}
{\cos{\theta}}
\end{align}
Where x is defined as the distance from the sending end, a is the line length, and \(V_s\) is the phasor voltage at the sending end. setting \(x=a\) and expression is derived for the voltage at the receiving end.
#+NAME: eqOpenCircuitRecEndV
\begin{align}
V_r =V(x=a) = \frac{V_s}{\cos{\theta}}
\end{align}
Since we assume that typical values of angle are \(\ll2\pi\) we know that as \theta grows we expect \(V_r\) to increase from being exactly equal to \(V_s\) to a value \(\ge V_s\)
** Matched Impedance Transmission line Voltage Distribution
The voltage profile for a line terminated in a matched impedance \(Z_0\) would yield a perfectly flat voltage distribution i.e. \(V(x) = V_s = V_r\). For any impedance greater than the surge impedance \((Z_0)\)  the voltage will tend to rise at the end of the transmission line while lower load impedance will cause the voltage profile in the line to sag leading to lower \(V_r\). [fn:: this can be expressed also as higher voltage for loads lower than the surge load where \(surge\: load \propto 1/Z_l\)]
*** Reactive Power Consumption
When the load impedance is matched to the surge impedance \((Z_0=Z_l)\), the reactive power consumption of the line is zero. When \(Z_l > Z_0\) the line generates reactive power whereas when \( Z_l < Z_0\) the line consumes reactive power.
* Experiment
** Line Parameters
Line parameters are given by Table ref:tabLineParams:
#+ATTR_LATEX: placement [H] :booktabs t:
#+caption: Per section model transmission line parameters
#+NAME: tabLineParams
|   | C_Sect (\mu F) | C_Tot (\mu F) | L_Sect (mH) | L_tot (mH) | N_Sections |
|---+--------------+-------------+-------------+------------+------------|
| _ | C_Sect_uF    | C_Tot_uF    | L_Sect_mH   | L_Tot_mH   | N_Sections |
| # | 0.02         | 0.2         | 7.29        | 72.9       | 10         |
#+TBLFM: $C_Tot_uF=$C_Sect_uF*$N_Sections::$L_Tot_mH=$L_Sect_mH*$N_Sections
** Experimental Parameters
Table
#+ATTR_LATEX: placement [H] :booktabs t:
#+caption: Signal generator settings
#+NAME: tabSigGen
|   | f (Hz) | \omega (Rad/s) | V_Src (V_pp) | V_Src (RMS) |
|---+--------+-----------+--------------+-------------|
| _ | f_Hz   | w_Rads    | srcVol_Vpp   | srcVol_Vrms |
| # | 700    | 4398.1    | 10           | 3.5355339   |
#+TBLFM:$w_Rads=$f_Hz*2*3.1415::$srcVol_Vrms=($srcVol_Vpp/2)*(1/sqrt(2))
** Surge Impedance (Part a)
Line surge impedance is calculated according to Equation ref:eqSurgeImpedance and the line parameters given in Table ref:tabLineParams. Table shows the resulting surge impedance:
#+ATTR_LATEX: placement [H] :booktabs t:
#+caption: Calculated Surge Impedance based on Equation ref:eqSurgeImpedance and Line Parameters in Table ref:tabLineParams
#+NAME: tabCalcSurgeImpedance
|   | Surge impedance Z_0 (\Omega) |
|---+-------------------------|
| _ | Z0_Ohm                  |
| # | 1.6563467e-3            |
#+TBLFM: @3$2=usimplify(sqrt((remote(tabLineParams,$C_Sect_uF) 10^-6 )/(remote(tabLineParams,$L_Sect_mH) 10^-3 )))
** Electrical length (Part b)
Electrical length is calculated from Equation ref:eqElectricalLength and the line total line parameters given in Table ref:tabLineParams. The results of the Calculation are shown in Table ref:tabElecLength.
#+ATTR_LATEX: placement [H] :booktabs t:
#+caption: Model Transmission line calculated Electrical Length according to Equation ref:eqElectricalLength and Transmission line parameters in ref:tabLineParams.
#+NAME: tabElecLength
|   | \theta (Rad)   | \theta (Deg) |
|---+-----------+---------|
| _ | LElec_Rad |         |
| # | 0.5311    | 30.4307 |
#+TBLFM: $3=($2/3.1415)*180;%0.4f::$LElec_Rad=remote(tabSigGen,$w_Rads)* sqrt(remote(tabLineParams,$C_Tot_uF)*remote(tabLineParams,$L_Tot_mH) 10^-6 10^-3);%0.4f
** Open Circuit Test (Part c)
*** Procedure
- Freq of signal gen set to 700Hz
- Output voltage set to 10V_pp
- Oscilloscope range to 2V/Division
- DVM used to measure RMS voltage along the line at the ten intervals
-
*** Results
#+ATTR_LATEX: placement [H] :booktabs t:
#+caption: Voltage Measurements along the model Transmission Line
#+NAME:tabVoltDistResults
|   | Measurement # | Elec Len at point \theta | Measured Voltage (V) |   V/V_Src |
|---+---------------+---------------------+----------------------+-----------|
| _ |        N_Meas |           Elect_Len |          V_Meas_Vrms | Vratio_Pu |
| # |             0 |              0.0000 |            3.5355339 |    1.0000 |
| # |             1 |              0.0531 |            3.5355339 |    1.0000 |
| # |             2 |              0.1062 |                3.715 |    1.0000 |
| # |             3 |              0.1593 |                3.802 |    1.0000 |
| # |             4 |              0.2124 |                3.878 |    1.0000 |
| # |             5 |              0.2655 |                3.944 |    1.0000 |
| # |             6 |              0.3186 |                3.997 |    1.0000 |
| # |             7 |              0.3717 |                4.040 |    1.0000 |
| # |             8 |              0.4248 |                4.070 |    1.0000 |
| # |             9 |              0.4780 |                4.089 |    1.0000 |
| # |            10 |              0.5311 |                4.095 |    1.0000 |
#+TBLFM: @4$4=remote(tabSigGen,$srcVol_Vrms)::$5=$V_Meas_Vrms/remote(tabSigGen,$srcVol_Vrms);%0.4f::$3=remote(tabSigGen,$w_Rads)* sqrt(remote(tabLineParams,$C_Sect_uF*$2)*remote(tabLineParams,$L_Sect_mH*$2) 10^-6 10^-3);%0.4f

#+BEGIN_SRC python :session :results file :output :var data=tabVoltDistResults :exports results :return saveName
from tabulate import tabulate
import pandas as pd
import matplotlib.pyplot as plt
saveName="voltDistResults.png"
df = pd.DataFrame(data[1:], columns=data[0])
ha = df.plot(x="N_Meas",y="Vratio_Pu",figsize=(8, 4))
plt.savefig(saveName)
#+END_SRC

#+ATTR_ORG: :width 500
#+ATTR_LATEX:  :width 400pt
#+ATTR_LATEX: :placement [H]
#+caption: Voltage Ratio along the Transmission Line
#+label: fig:
#+RESULTS:
[[file:voltDistResults.png]]
